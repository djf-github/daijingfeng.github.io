<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"djf-github.github.io","root":"/","scheme":"Muse","version":"7.7.2","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="Spring目前版本 3.x,4.x Spring整合Junit测试导包Spring- test 12345678910@RunWith(SpringJUnit4ClassRunner.class)@ContextConfiguration(&quot;classpth:applicationContext.xml&quot;)public class Demo&amp;#123;    @Resourc">
<meta property="og:type" content="article">
<meta property="og:title" content="Spring 笔记">
<meta property="og:url" content="https://djf-github.github.io/2018/05/31/Spring/index.html">
<meta property="og:site_name" content="我要养只大熊猫">
<meta property="og:description" content="Spring目前版本 3.x,4.x Spring整合Junit测试导包Spring- test 12345678910@RunWith(SpringJUnit4ClassRunner.class)@ContextConfiguration(&quot;classpth:applicationContext.xml&quot;)public class Demo&amp;#123;    @Resourc">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2018-05-31T14:37:54.000Z">
<meta property="article:modified_time" content="2020-03-08T18:23:05.388Z">
<meta property="article:author" content="djf">
<meta property="article:tag" content="Spring Java">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://djf-github.github.io/2018/05/31/Spring/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true
  };
</script>

  <title>Spring 笔记 | 我要养只大熊猫</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">我要养只大熊猫</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-fw fa-user"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>归档</a>

  </li>
        <li class="menu-item menu-item-commonweal">

    <a href="/404/" rel="section"><i class="fa fa-fw fa-heartbeat"></i>公益 404</a>

  </li>
  </ul>

</nav>
</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content">
            

  <div class="posts-expand">
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block " lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://djf-github.github.io/2018/05/31/Spring/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="djf">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="我要养只大熊猫">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Spring 笔记
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2018-05-31 22:37:54" itemprop="dateCreated datePublished" datetime="2018-05-31T22:37:54+08:00">2018-05-31</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-03-09 02:23:05" itemprop="dateModified" datetime="2020-03-09T02:23:05+08:00">2020-03-09</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Spring/" itemprop="url" rel="index"><span itemprop="name">Spring</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="Spring"><a href="#Spring" class="headerlink" title="Spring"></a>Spring</h1><p>目前版本 3.x,4.x</p>
<h2 id="Spring整合Junit测试"><a href="#Spring整合Junit测试" class="headerlink" title="Spring整合Junit测试"></a>Spring整合Junit测试</h2><p>导包Spring- test</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">@RunWith(SpringJUnit4ClassRunner.class)</span><br><span class="line">@ContextConfiguration(&quot;classpth:applicationContext.xml&quot;)</span><br><span class="line">public class Demo&#123;</span><br><span class="line">    @Resource(name&#x3D;&quot;userDao&quot;)</span><br><span class="line">    paivate	UserDao userDao</span><br><span class="line">    @Test</span><br><span class="line">    public void demo()&#123;</span><br><span class="line">        userDao.方法();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="IOC"><a href="#IOC" class="headerlink" title="IOC"></a>IOC</h2><p>概念:控制反转,把对象的创建交给Spring</p>
<h3 id="导包"><a href="#导包" class="headerlink" title="导包:"></a>导包:</h3><p>spring-beans-4.2.4.RELEASE.jar</p>
<p>spring-context-4.2.4.RELEASE.jar</p>
<p>spring-core-4.2.4.RELEASE.jar</p>
<p>spring-expression-4.2.4.RELEASE.jar</p>
<p>日志包</p>
<p>commons-logging-1.2.jar</p>
<p>com.springsource.org.apache.log4j-1.2.15.jar</p>
<h3 id="XML配置"><a href="#XML配置" class="headerlink" title="XML配置"></a>XML配置</h3><p>默认配置文件</p>
<p>applicationContext.xml</p>
<p>需要引入beans约束</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;beans 引入约束&gt;</span><br><span class="line">	&lt;bean id&#x3D;&quot;自定义名字&quot; class&#x3D;&quot;包名.类名&quot;&gt;			  &lt;&#x2F;bean&gt;</span><br><span class="line">&lt;&#x2F;beans&gt;</span><br></pre></td></tr></table></figure>

<p>调用</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">test</span><span class="params">()</span></span>&#123;</span><br><span class="line">    ApplicationContext applicationContext = <span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">"配置文件名"</span>);</span><br><span class="line">    类 引用(实例对象名) = applicationContext.getBean(<span class="string">"配置文件的id值"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="DI-依赖注入"><a href="#DI-依赖注入" class="headerlink" title="DI(依赖注入)"></a>DI(依赖注入)</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;bean&gt;</span><br><span class="line">	&lt;property name&#x3D;&quot;属性名&quot; value&#x3D;&quot;属性值&quot;&#x2F;&gt;</span><br><span class="line">&lt;&#x2F;bean&gt;</span><br></pre></td></tr></table></figure>

<h4 id="两个工厂类"><a href="#两个工厂类" class="headerlink" title="两个工厂类"></a>两个工厂类</h4><p>BeanFactory:</p>
<p>旧版本的,getBean的时候才会生成类的实例</p>
<p>ApplicationContext:</p>
<p>新版本的,加载配置文件的时候就会生成类的实例</p>
<p>它有两个实现类</p>
<p>ClassPathXmlApplicationContext:</p>
<p>加载类路径下的配置文件(src目录下)</p>
<p>FileSystemXmlApplicationContext:</p>
<p>加载文件系统下的配置文件</p>
<h4 id="Bean的相关配置"><a href="#Bean的相关配置" class="headerlink" title="Bean的相关配置"></a>Bean的相关配置</h4><p>id和name的区别</p>
<p>id使用了唯一约束 不能有特殊字符</p>
<p>name没有唯一约束,(理论上可以有相同值)</p>
<p>,实际开发中一般没有 可以有特殊字符</p>
<p>Bean的生命周期的配置:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;bean&gt;</span><br><span class="line">	&lt;property init-method&#x3D;&quot;&quot; destroy-method&#x3D;&quot;&quot;&#x2F;&gt;</span><br><span class="line">&lt;&#x2F;bean&gt;</span><br></pre></td></tr></table></figure>

<p>init-method     :Bean被初始化的时候调用的方法</p>
<p>destroy-method    :Bean被销毁的时候执行的方法</p>
<p>Bean是单例而且工厂被关闭才会被销毁</p>
<p>scope :Bean的作用范围</p>
<p>–singleton    :默认的,单例模式</p>
<p>–prototype    :多例模式</p>
<p>–request    :创建实例后存入request域中</p>
<p>–session    :创建实例后存入session域中</p>
<p>–globalsession    :创建实例后存入全局session中</p>
<h4 id="属性注入"><a href="#属性注入" class="headerlink" title="属性注入"></a>属性注入</h4><p>构造方法注入</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;bean&gt;</span><br><span class="line">	&lt;constructor-arg name&#x3D;&quot;属性名&quot; value&#x3D;&quot;属性值&#x2F;&gt;&quot;</span><br><span class="line">&lt;&#x2F;bean&gt;</span><br></pre></td></tr></table></figure>

<p>set注入</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;bean&gt;</span><br><span class="line">	&lt;property name&#x3D;&quot;属性名&quot; value&#x3D;&quot;属性值&quot;&#x2F;&gt;</span><br><span class="line">&lt;&#x2F;bean&gt;</span><br></pre></td></tr></table></figure>

<p>对象类型属性注入</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;bean&gt;</span><br><span class="line">	&lt;property name&#x3D;&quot;属性名&quot; ref&#x3D;&quot;对象id&quot;&#x2F;&gt;</span><br><span class="line">&lt;&#x2F;bean&gt;</span><br></pre></td></tr></table></figure>

<p>P名称空间属性注入(2.5版本以后)</p>
<p>写法:</p>
<p>普通属性        p属性名=”值”;</p>
<p>对象属性        p:属性名-ref=”值”;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;bean p:属性名&#x3D;&quot;属性值&quot; &gt;</span><br><span class="line">&lt;&#x2F;bean&gt;</span><br></pre></td></tr></table></figure>

<p>SpEL属性注入(3.0棒棒棒以后)</p>
<p>#{}</p>
<p>示例:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>集合类型属性注入</p>
<p>List集合或数组</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;bean&gt;</span><br><span class="line">	&lt;property name&#x3D;&quot;引用名&quot;&gt;</span><br><span class="line">		&lt;list&gt;</span><br><span class="line">			&lt;value&gt;值&lt;&#x2F;value&gt;</span><br><span class="line">			&lt;ref&#x2F;&gt;</span><br><span class="line">		&lt;&#x2F;list&gt;</span><br><span class="line">	&lt;&#x2F;property&gt;</span><br><span class="line">&lt;&#x2F;bean&gt;</span><br></pre></td></tr></table></figure>

<p>Map集合</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;bean&gt;</span><br><span class="line">	&lt;property name&#x3D;&quot;引用名&quot;&gt;</span><br><span class="line">		&lt;Map&gt;</span><br><span class="line">			&lt;entry key&#x3D;&quot;&quot; value&#x3D;&quot;&quot;&#x2F;&gt;</span><br><span class="line">		&lt;&#x2F;Map&gt;</span><br><span class="line">	&lt;&#x2F;property&gt;</span><br><span class="line">&lt;&#x2F;bean&gt;</span><br></pre></td></tr></table></figure>

<p>分模块开发</p>
<p>加载配置文件的时候加载多个:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ApplicationContext applicationContext = <span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">"配置文件名1"</span>,<span class="string">"配置文件名2"</span>);</span><br></pre></td></tr></table></figure>



<p>在一个配置文件中引入多个配置文件</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">import</span>  <span class="attr">resurce</span>=<span class="string">"文件名"</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="注解"><a href="#注解" class="headerlink" title="注解"></a>注解</h3><p>还需要导入aop 的jar包</p>
<p>需要引入context约束</p>
<p>配置</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">"src"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">context:component-scan</span></span></span><br></pre></td></tr></table></figure>

<p>创建对象</p>
<p>Component</p>
<p>有三个衍生注解(目前功能类似,后期会有扩展)</p>
<p>Controller(修饰web层)</p>
<p>service(修饰service层)</p>
<p>Repository(修饰dao层)</p>
<p>在类上面添加注解</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span>(value=<span class="string">"对象名"</span>)<span class="comment">//value可以省略</span></span><br></pre></td></tr></table></figure>

<p>注入属性</p>
<p>普通属性</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Value</span>(<span class="string">"属性值"</span>)</span><br></pre></td></tr></table></figure>

<p>对象属性</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">@Autowried  &#x2F;&#x2F;按照对象类型注入</span><br><span class="line">---------------</span><br><span class="line">@Autowried</span><br><span class="line">@Qualifiler(value&#x3D;&quot;对象名&quot;)&#x2F;&#x2F;按照名称注入</span><br><span class="line">-----------</span><br><span class="line">@Resurce(name&#x3D;&quot;对象名&quot;)&#x2F;&#x2F;按照名称注入</span><br></pre></td></tr></table></figure>

<p>如果没有set方法,在属性上面添加注解</p>
<p>如果有set方法,在方法上添加注解</p>
<p>其他注解</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">@PostConstruct</span><br><span class="line">初始化方法</span><br><span class="line">@PreDestroy</span><br><span class="line">销毁方法</span><br><span class="line">@Scope(&quot;&quot;)</span><br></pre></td></tr></table></figure>

<h3 id="XML和注解的比较"><a href="#XML和注解的比较" class="headerlink" title="XML和注解的比较"></a>XML和注解的比较</h3><p>XML:任何场景</p>
<p>–结构清晰,维护方便</p>
<p>注解:有些场景不能使用(例如这个类不是自己提供的)</p>
<p>–开发方便,速度快</p>
<p>XML和注解整合开发</p>
<p>XML管理Bean,注解完成属性注入</p>
<h2 id="AOP"><a href="#AOP" class="headerlink" title="AOP"></a>AOP</h2><p>面向切面编程</p>
<h3 id="底层实现原理"><a href="#底层实现原理" class="headerlink" title="底层实现原理"></a>底层实现原理</h3><p>1.动态代理</p>
<p>JDK动态代理        :只能对实现了接口的类产生代理</p>
<p>Cglib动态代理(第三方代理技术)    :对没有实现接口的类产生代理对象,通过生成子类对象的方式</p>
<p>AOP会自动切换</p>
<p>没有实现接口采用Cglib代理否则使用JDK代理</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">jdkProxy</span> <span class="keyword">implements</span> <span class="title">InvocationHandler</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> UserDao userDao;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">jdkProxy</span><span class="params">(UserDao userDao)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.userDao = userDao;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> UserDao <span class="title">createProxy</span><span class="params">()</span></span>&#123;</span><br><span class="line">        UserDao userDaoProxy = 					Proxy.newProxyInstance(userDao.getClass().getClassLoader(),userDao.getClass().getInterfaces(),<span class="keyword">this</span>);</span><br><span class="line">        <span class="keyword">return</span> userDaoProxy;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> object <span class="title">invoke</span><span class="params">(Object proxy,Method method,Object[] args)</span> <span class="keyword">throws</span> Throwable</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="string">"save"</span>.equals(method.getName()))&#123;</span><br><span class="line">            System.out.println(<span class="string">"权限校验"</span>)<span class="string">'</span></span><br><span class="line"><span class="string">                return method.invoke(userDao,args);</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string"> return method.invoke(userDao,args); </span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="AOP相关术语"><a href="#AOP相关术语" class="headerlink" title="AOP相关术语"></a>AOP相关术语</h3><p>joinpoint :连接点</p>
<p>Pointcut:切入点</p>
<p>Advice:(通知/增强)</p>
<p>Introduction :引介</p>
<p>target :目标对象</p>
<p>Weaving :织入</p>
<p>Proxy:代理</p>
<p>Aspect:切面</p>
<h3 id="导包-1"><a href="#导包-1" class="headerlink" title="导包"></a>导包</h3><p>spring-aop-4.2.4.RELEASE.jar</p>
<p>spring-aspects-4.2.4.RELEASE.jar</p>
<p>com.springsource.org.aopalliance-1.0.0.jar</p>
<p>com.springsource.org.aspectj.weaver-1.6.8.RELEASE.jar</p>
<p>配置</p>
<p>引入aop约束</p>
<p>XML方式AOP使用</p>
<p>创建切面类并配置到Spring的Bean管理中</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//切面类</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyAspectXML</span></span>&#123;</span><br><span class="line"><span class="comment">//通知</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">checkPri</span><span class="params">()</span></span>&#123;&#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">aop:config</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">aop:pointcut</span> <span class="attr">expession</span>=<span class="string">"execution(切入点)"</span> <span class="attr">id</span>=<span class="string">"qqqq"</span>&gt;</span>	<span class="tag">&lt;/<span class="name">aop:pointcut</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:aspect</span> <span class="attr">ref</span>=<span class="string">"切面类"</span>&gt;</span></span><br><span class="line">    	<span class="tag">&lt;<span class="name">aop:before</span> <span class="attr">method</span>=<span class="string">""</span> <span class="attr">pointcut-ref</span>=<span class="string">"qqqq"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">aop:aspect</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">aop:config</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="通知-增强-的类型"><a href="#通知-增强-的类型" class="headerlink" title="通知(增强)的类型"></a>通知(增强)的类型</h3><p>前置通知</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">aop:before</span> <span class="attr">method</span>=<span class="string">""</span> <span class="attr">point-ref</span>=<span class="string">"切入点配置的id值"</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<p>后置通知</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">aop:after-returing</span> <span class="attr">method</span>=<span class="string">""</span> <span class="attr">point-ref</span>=<span class="string">"切入点配置的id值"</span> <span class="attr">returing</span>=<span class="string">"xx"</span>/&gt;</span></span><br><span class="line">//获取方法返回值</span><br><span class="line">public void 通知(Object xx)&#123;&#125;</span><br></pre></td></tr></table></figure>

<p>环绕通知    :在方法执行之前和之后操作</p>
<p>可以阻止方法的执行</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">aop:around</span> <span class="attr">method</span>=<span class="string">"通知"</span> <span class="attr">point-ref</span>=<span class="string">"切入点配置的id值"</span>/&gt;</span></span><br></pre></td></tr></table></figure>



<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//通知</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> Object <span class="title">around</span><span class="params">(ProceedingJoinPoint joinPoint)</span> <span class="keyword">throws</span> Throwable</span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"环绕前通知---"</span>);</span><br><span class="line">    Object object = joinPoint.proced();</span><br><span class="line">    System.out.println(<span class="string">"环绕后通知---"</span>);</span><br><span class="line">    <span class="keyword">return</span> object</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>异常抛出通知:在程序出现异常时操作</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">aop:after-throwing</span> <span class="attr">method</span>=<span class="string">"通知"</span> <span class="attr">point-ref</span>=<span class="string">"切入点配置的id值"</span> <span class="attr">throwing</span>=<span class="string">"ex"</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> 增强(Throwable ex)&#123;</span><br><span class="line">	ex.getmessage</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>最终通知    :总是被执行  和finnally的效果</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;aop:after method&#x3D;&quot;通知&quot; point-ref&#x3D;&quot;切入点配置的id值&quot;&#x2F;&gt;</span><br></pre></td></tr></table></figure>

<p>引介通知</p>
<p>获得切入点信息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">public void 通知(Joinpoint joinPoint)&#123;</span><br><span class="line">    ex.getMessage</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="切入点表达式的写法"><a href="#切入点表达式的写法" class="headerlink" title="切入点表达式的写法"></a>切入点表达式的写法</h3><p>基于execution的函数完成的</p>
<p>语法</p>
<p>–[访问修饰符] 方法返回值 包名.类名.方法名(参数)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">*	* . * . *Dao.save(...)&#x2F;&#x2F;所有Dao的save方法	*	包名.类名+.save(...)&#x2F;&#x2F;指定类及其子类的方法	*	包名..*.*(...) &#x2F;&#x2F;指定包及其子包的	* 		*.*.aaa*(...)&#x2F;&#x2F;以aaa开头的方法</span><br></pre></td></tr></table></figure>

<h3 id="注解-1"><a href="#注解-1" class="headerlink" title="注解"></a>注解</h3><p>配置</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">aop:aspectj-autoproxy</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Aspect</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyAspect</span></span>&#123;</span><br><span class="line">    <span class="meta">@Before</span>(value=<span class="string">"execution()"</span>)</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> 增强()&#123;&#125;</span><br><span class="line">        </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>注解的通知类型</p>
<p>@Before</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Before</span>(value=<span class="string">"execution()"</span>)</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> 增强()&#123;&#125;</span><br></pre></td></tr></table></figure>

<p>@AfterRturing</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">@AfterRturing(value&#x3D;&quot;execution()&quot;,returning&#x3D;&quot;xx&quot;)</span><br><span class="line">    public void 增强(Object xx)&#123;&#125;</span><br></pre></td></tr></table></figure>

<p>@Around</p>
<p>@AfterThrowing</p>
<p>@After</p>
<p>@Pointcut</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">@Pointcut(value&#x3D;&quot;execution()&quot;)</span><br><span class="line">private void fun1()&#123;&#125;</span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">@Before(value&#x3D;&quot;切面类.fun1&quot;)</span><br><span class="line">    public void 增强()&#123;&#125;</span><br><span class="line"> ....</span><br></pre></td></tr></table></figure>

<h2 id="JDBC模板"><a href="#JDBC模板" class="headerlink" title="JDBC模板"></a>JDBC模板</h2><h3 id="引入jar包"><a href="#引入jar包" class="headerlink" title="引入jar包"></a>引入jar包</h3><p>六个基础Spring包</p>
<p>mysql驱动包</p>
<p>Spriong-JDBC包</p>
<p>Spring-tx(管理事务)包</p>
<p>aop包</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">demo</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="comment">//创建连接池 ,Spring内置的默认的连接池</span></span><br><span class="line">    DriverManagerDataSource datasource = <span class="keyword">new</span> DriverManagerDataSource();</span><br><span class="line">    datasource.setDriverClassName(<span class="string">""</span>);</span><br><span class="line">    datasource.setUrl(<span class="string">""</span>);</span><br><span class="line">    datasource.setUsername(<span class="string">""</span>);</span><br><span class="line">    datasource.setpassword(<span class="string">""</span>);</span><br><span class="line">    <span class="comment">//创建JDBC模板</span></span><br><span class="line">    JdbcTemplate jdbcTemplate = <span class="keyword">new</span> JdbcTemplate(datasuorce);</span><br><span class="line">    jdbcTemplate.update(sql,args);</span><br><span class="line">    <span class="comment">//</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"dataSource"</span> <span class="attr">class</span>=<span class="string">"org.springframework.jdbc.datasource.DriverManagerDataSource"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driverClassName"</span> <span class="attr">value</span>=<span class="string">""</span>/&gt;</span></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"jdbcTemplate"</span><span class="attr">class</span>=        <span class="string">"org.springframework.jdbc.core.JdbcTemplate"</span>&gt;</span></span><br><span class="line">  	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"datasource"</span> <span class="attr">ref</span>=<span class="string">"dataSource"</span>/&gt;</span>  </span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="使用开源连接池"><a href="#使用开源连接池" class="headerlink" title="使用开源连接池"></a>使用开源连接池</h3><h4 id="DBCP连接池"><a href="#DBCP连接池" class="headerlink" title="DBCP连接池"></a>DBCP连接池</h4><p>导包</p>
<p>dbcp和pool</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;bean id&#x3D;&quot;dataSource&quot; class&#x3D;&quot;org.apache.commons.dbcp.BasicDataSource&quot;&gt;</span><br><span class="line">	&lt;property name&#x3D;&quot;driverClassName&quot; value&#x3D;&quot;&quot;&#x2F;&gt;</span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">&lt;&#x2F;bean&gt;</span><br></pre></td></tr></table></figure>



<h4 id="c3p0连接池"><a href="#c3p0连接池" class="headerlink" title="c3p0连接池"></a>c3p0连接池</h4><p>导入c3p0的jar包</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;bean id&#x3D;&quot;dataSource&quot; class&#x3D;&quot;org.apache.commons.v2.c3p0.ComboPooledDataSource&quot;&gt;</span><br><span class="line">	&lt;property name&#x3D;&quot;driverClassName&quot; value&#x3D;&quot;&quot;&#x2F;&gt;</span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">&lt;&#x2F;bean&gt;</span><br></pre></td></tr></table></figure>

<h4 id="引入连接池的外部配置文件"><a href="#引入连接池的外部配置文件" class="headerlink" title="引入连接池的外部配置文件"></a>引入连接池的外部配置文件</h4><p>新建jdbc.properties</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">jdbc.driverClass&#x3D;&quot;&quot;;</span><br><span class="line">....</span><br></pre></td></tr></table></figure>

<p>Spring配置文件中引入jdbc配置文件</p>
<p>两种方式</p>
<p>一: 通过一个bean标签引入(很少使用)</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.springframework.beans.factory.config.propertyplaceholderConfigurer"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"location"</span> <span class="attr">value</span>=<span class="string">"classpath:jdbc.properties"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>二:通过context标签引入</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;context:property-playeholder location&#x3D;&quot;classpath:jdbc.properties&quot;&#x2F;&gt;</span><br></pre></td></tr></table></figure>

<p>引入jdbc配置文件之后</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;bean id&#x3D;&quot;dataSource&quot; class&#x3D;&quot;org.apache.commons.v2.c3p0.ComboPooledDataSource&quot;&gt;</span><br><span class="line">	&lt;property name&#x3D;&quot;driverClassName&quot; value&#x3D;&quot;$&#123;jdbc.driverClass&#125;&quot;&#x2F;&gt;</span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">&lt;&#x2F;bean&gt;</span><br></pre></td></tr></table></figure>

<h2 id="Spring的事务管理的API"><a href="#Spring的事务管理的API" class="headerlink" title="Spring的事务管理的API"></a>Spring的事务管理的API</h2><p>spring进行事务管理的时候,首先平台事务管理器根据事务定义信息进行事务管理,在事务管理过程中,产生各种状态,然后将这些状态的信息记录到事务状态的对象中</p>
<p><strong>PlatformTransactionManager</strong>:平台事务管理器</p>
<p>平台事务管理器: 接口 ,是Spring用于管理的真正的对象</p>
<p>两个实现类:</p>
<p>–DataSourceTransactionManager :底层使用jdbc管理事务</p>
<p>–HibernateTransactionManager  :底层使用Hibernate管理事务</p>
<p><strong>TransactionDefinition</strong>:事务定义信息</p>
<p>事务定义: 用于定义事务的相关信息,</p>
<p>隔离级别,超时信息,传播行为,是否只读</p>
<p><strong>TransactionStatus</strong> :事务状态</p>
<p>事务状态:用于记录事务管理过程中.事物的状态的对象</p>
<p>传播行为:</p>
<p>主要用来解决业务之间方法相互调用</p>
<p>共有七种分为三类:</p>
<p>–保证多个操作在同一个事务中</p>
<p>​    PROPAGATION_REQUIRED</p>
<p>: 默认值  如果调用的业务有事务,则使用它的事务,如果没有则创建一个事务</p>
<p>​    PROPAGATION_SUPPORTS </p>
<p>:如果调用的业务有事务,则使用它的事务,如果没有则不使用事务</p>
<p>​    PROPAGATION_MANDATORY</p>
<p>:如果调用的业务有事务,则使用它的事务,如果没有则抛出异常</p>
<p>–保证多个操作不在同一个事务中</p>
<p>​    PROPAGATION_REQUIRES_NEW</p>
<p>:如果调用的业务有事务,则将它挂起(暂停),创建新事物,只包含自己的操作,如果没有事务也是如此</p>
<p>​    PROPAGATION_NOT_SUPPORTED</p>
<p>:如果调用的业务有事务,则将它挂起(暂停),然后不使用事务,</p>
<p>​    PROPAGATION_NEVER</p>
<p>:如果调用的业务有事务,则抛出异常</p>
<p>–嵌套式事务</p>
<p>PROPAGATION_NESTED</p>
<p>:</p>
<p>用途:如果调用的业务有事务,则按照它的事务执行,执行完成后设置一个保存点,执行自己的操作,如果没有异常,执行通过,如果有异常可以选择回滚到初始位置或保存点</p>
<p>写DAO时可以继承一个类来简化代码</p>
<p>它里面有setDataSource方法</p>
<p>并且会通过DataSource创建Jdbc模板</p>
<p>在Spring配置文件里面给dao注入一个连接池即可</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"dao"</span> <span class="attr">class</span>=<span class="string">"dao实现类"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"datasource"</span> <span class="attr">ref</span>=<span class="string">"datasource"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="配置事务管理器"><a href="#配置事务管理器" class="headerlink" title="配置事务管理器"></a>配置事务管理器</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"transactionManager"</span> <span class="attr">class</span>=<span class="string">"org.springframework.jdbc.datasource.DataSourceTransactionManager"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"dataSource"</span> <span class="attr">ref</span>=<span class="string">"dataSource"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="编程式管理事务"><a href="#编程式管理事务" class="headerlink" title="编程式管理事务"></a>编程式管理事务</h3><p>配置事务管理的模板</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"transactionTemplate"</span> <span class="attr">class</span>=<span class="string">"org.springframework.transaction.support.TransactionTemplate"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"transactionManager"</span> <span class="attr">ref</span>=<span class="string">"transactionManager"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>在业务层注入事务管理模板</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"Service"</span> <span class="attr">class</span>=<span class="string">"Service"</span>&gt;</span></span><br><span class="line">	 <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"dao"</span> <span class="attr">ref</span>=<span class="string">"dao"</span>/&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"transactionTemplate"</span> <span class="attr">ref</span>=<span class="string">"transactionTemplate"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Service</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> TransactionTemplate transactionTemplate;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">service1</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        transactionTemplate.excute(</span><br><span class="line">            <span class="keyword">new</span> TransactionCallbackWithoutResult()&#123;</span><br><span class="line">                <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doIntransactionWithoutResult</span><span class="params">(TransactionStatus transactionStatus)</span></span>&#123;</span><br><span class="line">                    dao方法</span><br><span class="line">                        </span><br><span class="line">                        ...</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="声明式事务管理"><a href="#声明式事务管理" class="headerlink" title="声明式事务管理"></a>声明式事务管理</h3><p>(主要使用,通过配置实现-AOP原理)</p>
<p>引入aop的四个包</p>
<h4 id="XML方式的声明式事务管理"><a href="#XML方式的声明式事务管理" class="headerlink" title="XML方式的声明式事务管理"></a>XML方式的声明式事务管理</h4><p>配置事务管理器: 上面有</p>
<p>配置事务的增强</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">tx:advice</span> <span class="attr">id</span>=<span class="string">"vv"</span> <span class="attr">transaction-manager</span>=<span class="string">"transactionManager"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">tx:attributes</span>&gt;</span></span><br><span class="line">    	<span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">"save*"</span> <span class="attr">...</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tx:attributes</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">tx:advice</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>AOP的配置</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">aop:config</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">aop:pointcut</span> <span class="attr">expression</span>=<span class="string">"execution()"</span> <span class="attr">id</span>=<span class="string">"aa"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:adviseradvice-ref="vv"</span> <span class="attr">pointcut-ref</span>=<span class="string">"aa"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">aop:config</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="注解方式的声明式事务管理"><a href="#注解方式的声明式事务管理" class="headerlink" title="注解方式的声明式事务管理"></a>注解方式的声明式事务管理</h4><p>配置事务管理器: 上面有</p>
<p>开启注解事务</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;tx:annotation-driven transaction-manger&#x3D;&quot;transactionManager&quot;&#x2F;&gt;</span><br></pre></td></tr></table></figure>

<p>在业务层添加注解</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Transaction</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Service</span></span>&#123;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/Spring-Java/" rel="tag"># Spring Java</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2018/05/30/java_web/" rel="prev" title="Web of Java">
      <i class="fa fa-chevron-left"></i> Web of Java
    </a></div>
      <div class="post-nav-item">
    <a href="/2018/06/02/Mybatis/" rel="next" title="Mybatis 基本知识">
      Mybatis 基本知识 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  

  </div>


          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Spring"><span class="nav-number">1.</span> <span class="nav-text">Spring</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Spring整合Junit测试"><span class="nav-number">1.1.</span> <span class="nav-text">Spring整合Junit测试</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#IOC"><span class="nav-number">1.2.</span> <span class="nav-text">IOC</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#导包"><span class="nav-number">1.2.1.</span> <span class="nav-text">导包:</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#XML配置"><span class="nav-number">1.2.2.</span> <span class="nav-text">XML配置</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#DI-依赖注入"><span class="nav-number">1.2.2.1.</span> <span class="nav-text">DI(依赖注入)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#两个工厂类"><span class="nav-number">1.2.2.2.</span> <span class="nav-text">两个工厂类</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Bean的相关配置"><span class="nav-number">1.2.2.3.</span> <span class="nav-text">Bean的相关配置</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#属性注入"><span class="nav-number">1.2.2.4.</span> <span class="nav-text">属性注入</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#注解"><span class="nav-number">1.2.3.</span> <span class="nav-text">注解</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#XML和注解的比较"><span class="nav-number">1.2.4.</span> <span class="nav-text">XML和注解的比较</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#AOP"><span class="nav-number">1.3.</span> <span class="nav-text">AOP</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#底层实现原理"><span class="nav-number">1.3.1.</span> <span class="nav-text">底层实现原理</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#AOP相关术语"><span class="nav-number">1.3.2.</span> <span class="nav-text">AOP相关术语</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#导包-1"><span class="nav-number">1.3.3.</span> <span class="nav-text">导包</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#通知-增强-的类型"><span class="nav-number">1.3.4.</span> <span class="nav-text">通知(增强)的类型</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#切入点表达式的写法"><span class="nav-number">1.3.5.</span> <span class="nav-text">切入点表达式的写法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#注解-1"><span class="nav-number">1.3.6.</span> <span class="nav-text">注解</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#JDBC模板"><span class="nav-number">1.4.</span> <span class="nav-text">JDBC模板</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#引入jar包"><span class="nav-number">1.4.1.</span> <span class="nav-text">引入jar包</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#使用开源连接池"><span class="nav-number">1.4.2.</span> <span class="nav-text">使用开源连接池</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#DBCP连接池"><span class="nav-number">1.4.2.1.</span> <span class="nav-text">DBCP连接池</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#c3p0连接池"><span class="nav-number">1.4.2.2.</span> <span class="nav-text">c3p0连接池</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#引入连接池的外部配置文件"><span class="nav-number">1.4.2.3.</span> <span class="nav-text">引入连接池的外部配置文件</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Spring的事务管理的API"><span class="nav-number">1.5.</span> <span class="nav-text">Spring的事务管理的API</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#配置事务管理器"><span class="nav-number">1.5.1.</span> <span class="nav-text">配置事务管理器</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#编程式管理事务"><span class="nav-number">1.5.2.</span> <span class="nav-text">编程式管理事务</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#声明式事务管理"><span class="nav-number">1.5.3.</span> <span class="nav-text">声明式事务管理</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#XML方式的声明式事务管理"><span class="nav-number">1.5.3.1.</span> <span class="nav-text">XML方式的声明式事务管理</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#注解方式的声明式事务管理"><span class="nav-number">1.5.3.2.</span> <span class="nav-text">注解方式的声明式事务管理</span></a></li></ol></li></ol></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">djf</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">10</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">7</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">14</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">djf</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> 强力驱动 v4.2.0
  </div>
  <span class="post-meta-divider">|</span>
  <div class="theme-info">主题 – <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> v7.7.2
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
